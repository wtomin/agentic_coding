version: 1.0
name: validate_conversion
parallelizable: true

goal: Validate converted files for syntax, imports, MindSpore API compatibility, rule compliance, and (optionally) parity vs Torch.

preconditions:
  - tests_written: true

directories:
  outputs: ../output
  examples: ../examples

steps:
  - id: discover_converted
    action: list_directory
    path: ../output
  - id: validate_ast
    action: python_ast_check
    for_each: discovered_files
  - id: validate_imports
    action: import_resolution_check
    for_each: discovered_files
  - id: validate_api
    action: mindspore_api_check
    for_each: discovered_files
  - id: validate_rules
    action: cross_reference_rules
    ruleset: ../INITIAL_PLAN.yaml
    for_each: discovered_files
  - id: parity_check
    action: compare_ms_vs_torch
    for_each: discovered_test_pairs
    condition: torch_reference_available

artifacts:
  - type: validation_reports
    location: ../logs
  - type: parity_results
    location: ../logs/parity_results.json
